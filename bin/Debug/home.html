<html class="ui-mobile">
<head>

    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>Multi-page template</title>
    <link rel="stylesheet" href="./themes/forgather.css" />
    <link rel="stylesheet" href="./themes/style.css" />
    <link rel="stylesheet" href="./themes/jquery.mobile.icons.min.css" />
    <link rel="stylesheet" href="./themes/jquery.mobile.structure-1.4.2.min.css" />
    <script src="./scripts/jquery-1.10.2.min.js"></script>
    <script src="./scripts/jquery.mobile-1.4.2.min.js"></script>
</head>

<body class="ui-mobile-viewport ui-overlay-b">
    <div data-role="page" id="show_user" data-theme="b">
        <div data-role="header" class="header">
            <div class="left"><a href="#invite_friend" data-transition="none"><img src="images/share.png" /></a><a href="#scan"><img src="images/scan.png" /></a></div>
            <div class="right"><a href="#show_user_panel" data-transition="none"><img src="images/friends.png" class="friends" /></a><a href="#show_user_menu" data-rel="popup" data-transition="fade"><img src="images/menu.png" /></a></div>
            <div class="center"><a href="#show_user" data-transition="none"><img src="images/logo.png" class="logo" /></a></div>

            <div data-role="popup" id="show_user_menu" data-theme="c" style="top:29px;">
                <ul data-role="listview" data-inset="false" data-position-to="window" style="min-width:210px;">
                    <li data-icon="false"><a href="#" onclick="feedback()" style="border-top:0px">Feedback</a></li>
                    <li data-icon="false"><a href="#" onclick="logout()">Logout</a></li>
                </ul>
            </div>
        </div>

        <div data-role="content" class="ui-content home" role="main">
            <div class="section">
                <div class="profile">
                    <div class="right"><a href="#edit_user" data-transition="none"><img src="images/edit.png" style="height:30px; width:auto;" /></a></div>
                    <div class="center">
                        <a href="#show_user_image" data-rel="popup" data-position-to="window" data-transition="fade"><img class="popphoto" src="images/profiles/nick.png" alt="profile"></a>
                    </div>
                    <p><span class="user_name">Please setup your account</span></p>
                </div>
            </div>
            <div data-role="popup" id="show_user_image" data-overlay-theme="b" data-theme="b" data-corners="false">
                <a href="#" data-rel="back" class="ui-btn ui-corner-all ui-shadow ui-btn-a ui-icon-delete ui-btn-icon-notext ui-btn-right">Close</a><img class="popphoto" src="images/profiles/nick.png" style="max-height:512px;" alt="profile">
            </div>
            <div class="section">
                <p class="left">
                    <img src="images/buttons/category_phone.png" />
                </p>
                <ul class="left">
                    <li>
                        <img src="images/buttons/category_phone_home.png" class="left" /><span class="left">+31 756 31 27 33</span>
                    </li>
                    <li>
                        <img src="images/buttons/category_phone_mobile.png" class="left" /><span class="left">+31 654 61 70 68</span>
                    </li>
                </ul>
                <div class="clear-fix"></div>
            </div>
            <div class="section">
                <p class="left">
                    <img src="images/buttons/category_contact.png" />
                </p>
                <ul class="left">
                    <li>
                        <img src="images/buttons/category_contact_one.png" class="left" /><span class="left">nick.van.der.meulen@hva.nl</span>
                    </li>
                    <li>
                        <img src="images/buttons/category_contact_one.png" class="left" /><span class="left">nick.van.der.m@gmail.com</span>
                    </li>
                </ul>
                <div class="clear-fix"></div>
            </div>
        </div>
        <div data-role="panel" id="show_user_panel" data-position="right" data-display="reveal" data-theme="b" class="ui-panel ui-panel-position-right ui-panel-display-reveal ui-body-b ui-panel-animate ui-panel-open">
            <div class="ui-panel-inner">
                <ul class="friends">
                    <li><a onclick="alert('soon')">Search contacts</a></li>
                </ul>
            </div>
        </div>
    </div>

    <div data-role="page" id="edit_user" data-theme="b">
        <div data-role="header" class="header">
            <div class="left"><a href="#invite_friend" data-transition="none"><img src="images/share.png" /></a></div>
            <div class="right"><a href="#edit_user_panel" data-transition="none"><img src="images/friends.png" class="friends" /></a></div>
            <div class="center"><a href="#show_user" data-transition="none"><img src="images/logo.png" class="logo" /></a></div>
        </div>

        <div data-role="content" class="ui-content home" role="main">
            <div class="section">
                <div class="profile">
                    <div class="center"><img src="images/profiles/nick.png" /></div>
                    <p>Edit your profile</p>
                </div>
            </div>
            <div class="section">
                Adress

                <a href="#edit_user_adress_popup" data-rel="popup" data-transition="none" id="eenrandomlink" class="ui-btn" data-position-to="window">Edit adress details</a>
                <div data-role="popup" id="edit_user_adress_popup" data-overlay-theme="b" data-theme="b">
                    <ul data-role="listview" data-inset="true" style="min-width:210px;">
                        <li data-role="list-divider">Contact</li>
                        <li><input type="text" alt="Street" /></li>
                        <li><input type="text" alt="Street number" /></li>
                        <li><input type="text" alt="Zip code" /></li>
                        <li><input type="text" alt="City" /></li>
                        <li><input type="text" alt="Country" /></li>
                        <li><a data-rel="back" class="ui-btn" onclick="saveProfile()">Save</a></li>
                    </ul>
                </div>
            </div>
            <div class="section">
                Contact

                <a href="#edit_user_contact" data-rel="popup" data-transition="none" id="eenrandomlink" class="ui-btn" data-position-to="window">Edit contact details</a>
                <div data-role="popup" id="edit_user_contact" data-overlay-theme="b" data-theme="b">
                    <ul data-role="listview" data-inset="true" style="min-width:210px;">
                        <li data-role="list-divider">Contact</li>
                        <li><input type="text" alt="Private number" id="edit_private_number" /></li>
                        <li><input type="text" alt="Work number" id="edit_work_number" /></li>
                        <li><input type="text" alt="Private mail" id="edit_private_mail" /></li>
                        <li><input type="text" alt="Work mail" id="edit_work_mail" /></li>
                        <li><a data-rel="back" class="ui-btn" onclick="saveProfile()">Save</a></li>
                    </ul>
                </div>
            </div>
        </div>

        <div data-role="panel" id="edit_user_panel" data-position="right" data-display="reveal" data-theme="b" class="ui-panel ui-panel-position-right ui-panel-display-reveal ui-body-b ui-panel-animate ui-panel-open">
            <div class="ui-panel-inner">
                <ul class="friends">
                    <li><a onclick="alert('soon')">Search contacts</a></li>
                </ul>
            </div>
        </div>
    </div>

    <div data-role="page" id="invite_friend" data-theme="b">
        <div data-role="header" class="header">
            <div class="left"><a href="#invite_friend" data-transition="none"><img src="images/share.png" /></a></div>
            <div class="right"><a href="#invite_friend_panel" data-transition="none"><img src="images/friends.png" class="friends" /></a></div>
            <div class="center"><a href="#show_user" data-transition="none"><img src="images/logo.png" class="logo" /></a></div>
        </div>

        <div data-role="content" class="ui-content home" role="main">
            <div class="section">
                <div class="profile">
                    <div class="center"><img src="images/profiles/nick.png" /></div>
                    <p><span class="user_name">Please setup your account</span></p>
                </div>
            </div>
            <p class="text_invite_friend">
                Please enter the email address of the Forgather account you would like to share cards with.
                <input type="text" id="invite_email" alt="Email" />
                <input type="button" value="Share cards" onclick="inviteFriend()" />
            </p>
            <p class="disclaimer_invite_friend">
                To finish the card sharing progress the recipient needs to accept your request first.
            </p>
        </div>

        <div data-role="panel" id="invite_friend_panel" data-position="right" data-display="reveal" data-theme="b" class="ui-panel ui-panel-position-right ui-panel-display-reveal ui-body-b ui-panel-animate ui-panel-open">
            <div class="ui-panel-inner">
                <ul class="friends">
                    <li><a onclick="alert('soon')">Search contacts</a></li>
                </ul>
            </div>
        </div>
    </div>

    <div data-role="page" id="show_friend" data-theme="b">
        <div data-role="header" class="header">
            <div class="left"><a href="#invite_friend" data-transition="none"><img src="images/share.png" /></a></div>
            <div class="right"><a href="#show_friend_panel" data-transition="none"><img src="images/friends.png" class="friends" /></a></div>
            <div class="center"><a href="#show_user" data-transition="none"><img src="images/logo.png" class="logo" /></a></div>
        </div>

        <div data-role="content" class="ui-content home" role="main">
            <div class="section">
                <div class="profile">
                    <div class="right"><a href="#show_user" data-transition="none" onclick="deleteFriend()"><img src="images/delete.png" style="height:30px; width:auto;" /></a></div>
                    <div class="center">
                        <a href="#show_user_image" data-rel="popup" data-position-to="window" data-transition="fade"><img class="popphoto" src="images/profiles/nick.png" alt="profile"></a>
                    </div>
                    <p><span class="friend_name">Friend name</span></p>
                </div>
            </div>
            <div data-role="popup" id="show_friend_image" data-overlay-theme="b" data-theme="b" data-corners="false">
                <a href="#" data-rel="back" class="ui-btn ui-corner-all ui-shadow ui-btn-a ui-icon-delete ui-btn-icon-notext ui-btn-right">Close</a><img class="popphoto" src="images/profiles/nick.png" style="max-height:512px;" alt="profile">
            </div>
            <div class="show_friend_invited">
                This person has requested to shair cards with you.

                <input type="button" value="Accept" onclick="acceptFriend(null)" /><input type="button" value="Decline" onclick="declineFriend(null)" />

            </div>
            <div class="show_friend_info">
                This person is now your friend and you will see the data from him.
            </div>
        </div>

        <div data-role="panel" id="show_friend_panel" data-position="right" data-display="reveal" data-theme="b" class="ui-panel ui-panel-position-right ui-panel-display-reveal ui-body-b ui-panel-animate ui-panel-open">
            <div class="ui-panel-inner">
                <ul class="friends">
                    <li><a onclick="alert('soon')">Search contacts</a></li>
                </ul>
            </div>
        </div>
    </div>

    <script src="scripts/database-connection.js"></script>
    <script>
        var profile;
        var friends;

        $(document).ready(function () {
            profile = JSON.parse(window.localStorage.getItem('profile'));

            if (profile.profileID != 0) {
                setProfileData();
            }
            getFriends();


            $("input:text, input:password").each(function () {
                $(this).val($(this).attr("alt"));
            });

            // clear input.text on focus, if still in default
            $("input:text, input:password").focus(function () {
                if ($(this).val() == $(this).attr("alt")) {
                    $(this).val("");
                }
            });

            // if field is empty afterward, add text again
            $("input:text, input:password").blur(function () {
                if ($(this).val() == "") {
                    $(this).val($(this).attr("alt"));
                }
            });
        });

        function feedback() {
            alert("You wish");
        }

        function logout() {
            profile = null;
            friends = [];
            window.location.href = "./index.html#login";
        }

        function setProfileData() {
            //home
            $('.user_name').text(profile.name);

            //edit
            $('#edit_name').val(profile.name);
            $('#edit_private_number').attr("alt", profile.privateNumber);
            $('#edit_work_number').attr("alt", profile.workNumber);
            $('#edit_private_mail').attr("alt", profile.privateMail);
            $('#edit_work_mail').attr("alt", profile.workMail);
            $('#edit_facebook').val(profile.facebook);
            $('#edit_twitter').val(profile.twitter);
            $('#edit_linkedin').val(profile.linkedin);
            $('#edit_instagram').val(profile.instagram);
            $('#edit_skype').val(profile.skype);
            $('#edit_googlePlus').val(profile.googlePlus);
            $('#edit_pinterest').val(profile.pinterest);
            $('#edit_unkown').val(profile.unknown);
            $('#edit_soundcloud').val(profile.soundcloud);
            $('#edit_steam').val(profile.steam);
            $('#edit_playstation').val(profile.playstation);
            $('#edit_xbox').val(profile.xbox);
        }

        function saveProfile() {
            //profile.name = $('#edit_name').val();
            profile.privateNumber = $('#edit_private_number').val();
            profile.workNumber = $('#edit_work_number').val();
            profile.privateMail = $('#edit_private_mail').val();
            profile.workMail = $('#edit_work_mail').val();
            profile.facebook = $('#edit_facebook').val();
            profile.twitter = $('#edit_twitter').val();
            profile.linkedin = $('#edit_linkedin').val();
            profile.instagram = $('#edit_instagram').val();
            profile.skype = $('#edit_skype').val();
            profile.googlePlus = $('#edit_googlePlus').val();
            profile.pinterest = $('#edit_pinterest').val();
            profile.unknown = $('#edit_unkown').val();
            profile.soundcloud = $('#edit_soundcloud').val();
            profile.steam = $('#edit_steam').val();
            profile.playstation = $('#edit_playstation').val();
            profile.xbox = $('#edit_xbox').val();

            console.log(profile);

            $.ajax({
                url: url + 'api/profile/postprofile',
                type: 'POST',
                async: false,
                contentType: 'application/json',
                data: JSON.stringify(profile),
                success: function (data) {
                    location.hash = "show_user";
                    profile = data;
                    window.localStorage.setItem('profile', JSON.stringify(data));
                    setProfileData();
                },
                error: function (e) {
                    alert("Something went wrong.");
                },
                dataType: 'json',
                contentType: "application/json"
            });
        }
    </script>
    <script src="scripts/friend.js"></script>
</body>

</html>
